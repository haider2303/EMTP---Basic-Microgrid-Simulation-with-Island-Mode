! Generated by EMTPWorks version E4.1.2 Wednesday, November 25, 2020 10:12 PM
!
Application.ProgressCLSID={AAE149D5-7852-4AA4-6AF4-1BC4AA2733D1}
Circuit.Diagram=MicroGrid.ecf;
Circuit.Date=25/11/2020 22:07:29;
!
Dt=50us;
tmax=1;
LoadFlow=1;
!
! The following lines are derived from option symbols
! on the schematic, Datafile in Function attribute, ModelData will contain the inserted file name
!
!
! Subcircuit definitions defined in design
!
<ABC_DQ0_b7d00b1b;7;s17,s33,s21,s22,s4,s1,s13,
_c_fu;Fm7;2;2;sinus,s13,
0,S0,
[SIN]
_c_fu;Fm8;2;2;cosinus,s13,
0,S0,
[COS]
_c_fu;Fm9;3;3;s35,s33,cosinus,
0,S0,
[PROD]
_c_fu;Fm10;3;3;s36,s17,sinus,
0,S0,
[PROD]
_c_fu;Fm11;3;3;s39,s33,sinus,
0,S0,
[PROD]
_c_fu;Fm12;3;3;s41,s17,cosinus,
0,S0,
[PROD]
_c_gain;Gain2;2;2;s4,s1,
1,S0,
_c_sum;sum1;3;3;s21,s36,s35,
0,1,S0,
+1 -1
_c_sum;sum2;3;3;s22,s41,s39,
0,1,S0,
+1 +1
>
<ABC_DQ0_c4caaa96;7;s17,s33,s21,s22,s4,s1,s13,
_c_fu;Fm4;3;3;s35,s33,cosinus,
0,S0,
[PROD]
_c_fu;Fm5;3;3;s36,s17,sinus,
0,S0,
[PROD]
_c_fu;Fm6;3;3;s39,s33,sinus,
0,S0,
[PROD]
_c_fu;Fm13;3;3;s41,s17,cosinus,
0,S0,
[PROD]
_c_fu;Fm14;2;2;sinus,s13,
0,S0,
[SIN]
_c_fu;Fm15;2;2;cosinus,s13,
0,S0,
[COS]
_c_gain;Gain1;2;2;s4,s1,
1,S0,
_c_sum;sum3;3;3;s22,s41,s39,
0,1,S0,
+1 +1
_c_sum;sum4;3;3;s21,s36,s35,
0,1,S0,
+1 -1
>
<Cjump_8c2b0376;2;s18,s18,
>
<Cjump_ba13a882;2;s18,s18,
>
<Clark_inv_c2f82dc9;6;s76,s75,s44,s12,s13,s11,
_c_fu;Fm2;4;4;s76,s13,s12,s11,
0,S0,
u[1]+u[3]
_c_fu;Fm10;4;4;s75,s13,s12,s11,
0,S0,
(1/2)*(-u[1]+SQRT(3)*u[2]+2*u[3])
_c_fu;Fm16;4;4;s44,s13,s12,s11,
0,S0,
(1/2)*(-u[1]-SQRT(3)*u[2]+u[3])
>
<Convert_to_pu_eb71bfc1;28;Vabc_Yva,Vabc_Yvb,Vabc_Yvc,Vabc_Y_puva,Vabc_Y_puvb,Vabc_Y_puvc,Iabc_Yia,
Iabc_Yib,Iabc_Yic,Iabc_Y_puia,Iabc_Y_puib,Iabc_Y_puic,Vabc_Dva,Vabc_Dvb,Vabc_Dvc,Vabc_D_puva,
Vabc_D_puvb,Vabc_D_puvc,Iabc_Dia,Iabc_Dib,Iabc_Dic,Iabc_D_puia,Iabc_D_puib,Iabc_D_puic,s18,s19,s1,
s2,
_c_loss;to_pu1;2;2;s19,s18,
#Vdc_V#,S0,
_c_loss;to_pu2;2;2;Vabc_Y_puva,Vabc_Yva,
#Vac_primary_V#,S0,
_c_loss;to_pu3;2;2;Vabc_Y_puvb,Vabc_Yvb,
#Vac_primary_V#,S0,
_c_loss;to_pu4;2;2;Vabc_Y_puvc,Vabc_Yvc,
#Vac_primary_V#,S0,
_c_loss;to_pu5;2;2;Iabc_Y_puia,Iabc_Yia,
#Iac_primary_A#,S0,
_c_loss;to_pu6;2;2;Iabc_Y_puib,Iabc_Yib,
#Iac_primary_A#,S0,
_c_loss;to_pu7;2;2;Iabc_Y_puic,Iabc_Yic,
#Iac_primary_A#,S0,
_c_loss;to_pu8;2;2;s2,s1,
#Idc_A#,S0,
_c_loss;to_pu9;2;2;Iabc_D_puia,Iabc_Dia,
#Iac_secondary_A#,S0,
_c_loss;to_pu10;2;2;Iabc_D_puib,Iabc_Dib,
#Iac_secondary_A#,S0,
_c_loss;to_pu11;2;2;Iabc_D_puic,Iabc_Dic,
#Iac_secondary_A#,S0,
_c_loss;to_pu12;2;2;Vabc_D_puva,Vabc_Dva,
#Vac_secondary_V#,S0,
_c_loss;to_pu13;2;2;Vabc_D_puvb,Vabc_Dvb,
#Vac_secondary_V#,S0,
_c_loss;to_pu14;2;2;Vabc_D_puvc,Vabc_Dvc,
#Vac_secondary_V#,S0,
>
<Convert_to_pu_eb74323d;28;Vabc_Yva,Vabc_Yvb,Vabc_Yvc,Vabc_Y_puva,Vabc_Y_puvb,Vabc_Y_puvc,Iabc_Yia,
Iabc_Yib,Iabc_Yic,Iabc_Y_puia,Iabc_Y_puib,Iabc_Y_puic,Vabc_Dva,Vabc_Dvb,Vabc_Dvc,Vabc_D_puva,
Vabc_D_puvb,Vabc_D_puvc,Iabc_Dia,Iabc_Dib,Iabc_Dic,Iabc_D_puia,Iabc_D_puib,Iabc_D_puic,s2,s3,s1,s4,
_c_fs;fs1;2;2;Vabc_Y_puva,Vabc_Yva,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs2;2;2;Vabc_Y_puvb,Vabc_Yvb,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs3;2;2;Vabc_Y_puvc,Vabc_Yvc,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs4;2;2;Iabc_Y_puia,Iabc_Yia,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs5;2;2;Iabc_Y_puib,Iabc_Yib,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs6;2;2;Iabc_Y_puic,Iabc_Yic,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs7;2;2;Vabc_D_puva,Vabc_Dva,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs8;2;2;Vabc_D_puvb,Vabc_Dvb,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs9;2;2;Vabc_D_puvc,Vabc_Dvc,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs10;2;2;Iabc_D_puia,Iabc_Dia,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs11;2;2;Iabc_D_puib,Iabc_Dib,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs12;2;2;Iabc_D_puic,Iabc_Dic,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs13;2;2;s3,s2,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
_c_fs;fs14;2;2;s4,s1,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
>
<DC_Droop_Voltage_96768198;5;s4,s7,s31,s33,s32,
_c_fu;Fm1;3;3;s5,s11,s32,
0,S0,
[PROD]
_c_fu;Fm2;4;4;s11,s7,s31,s33,
0,S0,
(u[1]>u[2])*(u[1]-u[2]) + (u[1]<u[3])*(u[1]-u[3])
_c_gain;Gain1;2;2;s4,s5,
-1,S0,
>
<DC_side_a1f74f4f;7;s19,s20,s21,s5,s2,s7,s4,
_c_fu;Fm36;7;7;s5,s7,s2,s4,s19,s20,s21,
0,S0,
(u[1]*u[4]+u[2]*u[5]+u[3]*u[6])/2
>
<Delais_variable_b60c2f36;3;s15,s26,VAR_DELAY,
_c_dlyvar;dly1;2;2;s15,s26,
1,0,#PLL_max_delay#,S0,
VAR_DELAY
>
<Derive_b2d937ec;2;s1,s51,
_c_fu;Fm3;2;2;s51,s31,
0,S0,
u[1]*#Td_d#/#tau_d#
_c_fu;Fm4;2;2;s38,s51,
0,S0,
u[1]*1/(#Td_d#+1e-10)
_c_i;Int2;2;2;s34,s38,
0,S0,
_c_sum;sum5;3;3;s31,s1,s34,
0,1,S0,
+1 -1
>
<Filters_b7d9430f;3;BUS1a,BUS1b,BUS1c,
_RLC;Cfilter1a;2;2;BUS1a,s41a,
0,0,#Cfilter1_F#,0,0,
_RLC;Cfilter1b;2;2;BUS1b,s41b,
0,0,#Cfilter1_F#,0,0,
_RLC;Cfilter1c;2;2;BUS1c,s41c,
0,0,#Cfilter1_F#,0,0,
_RLC;Lfilter1a;2;2;s41a,,
0,#Lfilter1_H#,0,0,0,
_RLC;Lfilter1b;2;2;s41b,,
0,#Lfilter1_H#,0,0,0,
_RLC;Lfilter1c;2;2;s41c,,
0,#Lfilter1_H#,0,0,0,
_RLC;Rfilter1a;2;2;s41a,,
#Rfilter1_Ohm#,0,0,0,0,
_RLC;Rfilter1b;2;2;s41b,,
#Rfilter1_Ohm#,0,0,0,0,
_RLC;Rfilter1c;2;2;s41c,,
#Rfilter1_Ohm#,0,0,0,0,
>
<LP_filter_2nd_odrer_adb07a20;2;s135,s136,
_c_fs;fs1;2;2;s135,s136,
0,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
>
<LP_filter_2nd_odrer_c64125af;2;s135,s136,
_c_fs;fs1;2;2;s135,s136,
H,1,1,3,1,S0,
#init_value#
;
1 
;
1 #wT_eps# #wT_2# 
>
<LP_filter_2nd_odrer_dc2ce5e1;2;s135,s136,
_c_fs;fs1;2;2;s135,s136,
#Freq#,1,1,3,1,S0,
1 
;
1 #wT_eps# #wT_2# 
>
<LPfilter_2nOrder_b0042544;2;s2,s4,
_c_fs;fs1;2;2;s2,s4,
0,1,1,2,1,S0,
1 
;
1 #wT# 
>
<LPfilter_2nOrder_c60d6d67;2;s2,s4,
_c_fs;fs1;2;2;s2,s4,
H,1,2,2,1,S0,
#init_value#
;
0 #wT# 
;
1 #wT# 
>
<Main_Sw_d37eb50a;7;BUS1a,BUS1b,BUS1c,s10a,s10b,s10c,s1,
_cSw;phA;3;3;BUS1a,s10a,s1,
,1,0,1,1e-03,1e09,
_cSw;phB;3;3;BUS1b,s10b,s1,
,1,0,1,1e-03,1e09,
_cSw;phC;3;3;BUS1c,s10c,s1,
,1,0,1,1e-03,1e09,
>
<Main_Sw_d37fc89b;7;BUS1a,BUS1b,BUS1c,s10a,s10b,s10c,s1,
_cSw;phA;3;3;BUS1a,s10a,s1,
,1,0,1,1e-03,1e09,
_cSw;phB;3;3;BUS1b,s10b,s1,
,1,0,1,1e-03,1e09,
_cSw;phC;3;3;BUS1c,s10c,s1,
,1,0,1,1e-03,1e09,
>
<Oscillator_fef34d3b;4;wt,s6,s15,s16,
_c_cst;Freq;1;1;s5,
#Freq#,S0,
_c_gain;2_PI;2;2;s28,s6,
6.283185307179586,S0,
_c_gain;m;2;2;s13,s10,
#droop_m#,S0,
_c_i;Int3;2;2;wt,s28,
0,S0,
_c_sum;sum1;3;3;s6,s5,s13,
0,1,S0,
+1 -1
_c_sum;sum2;3;3;s10,s15,s16,
0,1,S0,
+1 -1
>
<PI_ini_e9892eed;3;out_ini,u,iudt_ini,
_c_fu;iudt_ini;3;3;iudt_ini,out_ini,u,
0,S0,
( u[1] - #PLL_kp# * u[2] ) / #PLL_ki#
>
<Park_inv_cda700ad;7;s40,s32,s28,s6,s36,s37,s39,
_c_fu;Fm1;3;3;s3,s28,cosinus,
0,S0,
[PROD]
_c_fu;Fm2;3;3;s4,s6,sinus,
0,S0,
[PROD]
_c_fu;Fm3;3;3;s9,s28,sinus,
0,S0,
[PROD]
_c_fu;Fm4;3;3;s8,s6,cosinus,
0,S0,
[PROD]
_c_fu;Fm5;2;2;cosinus,s40,
0,S0,
[COS]
_c_fu;Fm6;2;2;sinus,s40,
0,S0,
[SIN]
_c_gain;Gain2;2;2;s39,s32,
1,S0,
_c_sum;sum3;3;3;s36,s4,s3,
0,1,S0,
+1 +1
_c_sum;sum4;3;3;s37,s8,s9,
0,1,S0,
-1 +1
>
<Protect_StartUp_cb9ecf8d;8;s10,s41,s68,s64,s8,s16va,s16vb,s16vc,
_c_cst;C1;1;1;s8,
#StarPointReactor_BRK#,S0,
_c_cst;C2;1;1;s10,
1,S0,
_c_cst;C3;1;1;block_inverter_DeepVoltageSag,
0,S0,
_c_dly;dly1;2;2;s64,s63,
1,0,4e-5,S0,
_c_dly;dly2;2;2;s68,AC_BRK_IdcProtection,
1,0,0.04,S0,
_c_dlydis;dly3;2;2;s243,s107,
0,1,S0,
_c_fu;Fm8;4;4;s63,block_MMC_BRK,block_inverter_IdcProtection,block_inverter_DeepVoltageSag,
0,S0,
[SUM]
_c_fu;Fm9;2;2;AC_BRK_IdcProtection,block_inverter_IdcProtection,
0,S0,
[NOT]
_c_fu;Fm10;3;3;s107,s196,s243,
0,S0,
u[1]*(u[2]<0.5)+ (u[2]>0.5)
_c_fu;Fm11;2;2;s196,s6,
0,S0,
ABS(u[1])>#Idc_limit#
_c_fu;Protection_init1;2;2;s6,s41,
0,S0,
u[1]*( t>#init_Protection# )
_c_fu;activate_protection;2;2;block_inverter_IdcProtection,s107,
0,S0,
u[1]*( #activate_Protection# > 0)
>
<SMV_97b36dfb;3;s40,s58,s72,
_c_fu;Fm2;3;3;s72,s59,s63,
0,S0,
u[1]-u[2]
_c_prbv;p1;2;2;s59,s40,
0,S0,
_c_prbv;p2;2;2;s63,s58,
0,S0,
>
<SMV_bfbafbc8;3;s40,s58,s72,
_c_fu;Fm1;3;3;s72,s59,s63,
0,S0,
u[1]-u[2]
_c_prbv;p4;2;2;s59,s40,
0,S0,
_c_prbv;p5;2;2;s63,s58,
0,S0,
>
<Vac_ae114dfb;3;s107,s3,s101,
_c_fu;Fm7;3;3;s107,s3,s101,
0,S0,
u[1]*u[2]/2
>
<Vprobe3_118c9ca5;6;s36,s38,s40,pa,pb,pc,
_c_prbv;P1;2;2;s36,pa,
0,
_c_prbv;P2;2;2;s38,pb,
0,
_c_prbv;P3;2;2;s40,pc,
0,
>
<Vprobe3_330f7b90;6;s36,s38,s3,BUS1a,BUS1b,BUS1c,
_c_gain;va_t;2;2;s36,s11,
#base#,S0,#va_scope#,
_c_gain;vb_t;2;2;s38,s5,
#base#,S0,#vb_scope#,
_c_gain;vc_t;2;2;s3,s6,
#base#,S0,#vc_scope#,
_c_prbv;va;2;2;s11,BUS1a,
0,S0,
_c_prbv;vb;2;2;s5,BUS1b,
0,S0,
_c_prbv;vc;2;2;s6,BUS1c,
0,S0,
>
<i_probe_b08db5cf;3;s15,s16,s1,
_Sw0;sw;2;2;s15,s16,
-1,1E15,0,>i,
_c_gain;i_t;2;2;s1,i_sw,
#base#,S0,#scope#,
>
<initialization_ddd00238;6;BUS_PCCa,BUS_PCCb,BUS_PCCc,s10a,s10b,s10c,
_PQbus;PQ_LFa;3;1;s11a,
#Freq#,#LF_V#,0,1,#LF_P1_W#,#LF_Q_VAR#,1,1,1Ohm,1,,
_PQbus;PQ_LFb;3;1;s11b,
_PQbus;PQ_LFc;3;1;s11c,
1e-5 1e-5 1e-5
1e-5 1e-5 1e-5
_RLC;R1a;2;2;BUS_PCCa,,
1M,0,0,0,0,,60,,0,0,
_RLC;R1b;2;2;BUS_PCCb,,
1M,0,0,0,0,,60,,0,0,
_RLC;R1c;2;2;BUS_PCCc,,
1M,0,0,0,0,,60,,0,0,
_RLC;R2a;2;2;BUS_PCCa,s3a,
1e-6,0,0,0,0,,60,,0,0,
_RLC;R2b;2;2;BUS_PCCb,s3b,
1e-6,0,0,0,0,,60,,0,0,
_RLC;R2c;2;2;BUS_PCCc,s3c,
1e-6,0,0,0,0,,60,,0,0,
_Sw0;SW_LFa;2;2;s11a,s3a,
#t_init_close1#,#t_init#,0,0,0,,1,.1,.001,5,
_Sw0;SW_LFb;2;2;s11b,s3b,
#t_init_close1#,#t_init#,0,0,0,,1,.1,.001,5,
_Sw0;SW_LFc;2;2;s11c,s3c,
#t_init_close1#,#t_init#,0,0,0,,1,.1,.001,5,
_Sw0;SW_MMCstationa;2;2;s10a,BUS_PCCa,
#t_init_close2#,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW_MMCstationb;2;2;s10b,BUS_PCCb,
#t_init_close2#,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW_MMCstationc;2;2;s10c,BUS_PCCc,
#t_init_close2#,1E15,0,0,0,,1,.1,.001,5,
_Vsine_z;PQ_inita;6;2;s17a,s11a,
#LF_V#,#Freq#,0,-1,1E15,PQbus:PQ_LF,1,1,1Ohm,1,0,
_Vsine_z;PQ_initb;6;2;s17b,s11b,
#LF_V#,#Freq#,-120,-1,1E15,0,
_Vsine_z;PQ_initc;6;2;s17c,s11c,
#LF_V#,#Freq#,120,-1,1E15,0,
1e-5 1e-5 1e-5
1e-5 1e-5 1e-5
>
<ip__3_aecc3541;9;s4a,s4b,s4c,s5a,s5b,s5c,s1,s2,s3,
_Sw0;swa;2;2;s4a,s5a,
-1,1E15,0,>i,
_Sw0;swb;2;2;s4b,s5b,
-1,1E15,0,>i,
_Sw0;swc;2;2;s4c,s5c,
-1,1E15,0,>i,
_c_gain;ia_t;2;2;s1,i_swa,
#base#,S0,#ia_scope#,
_c_gain;ib_t;2;2;s2,i_swb,
#base#,S0,#ib_scope#,
_c_gain;ic_t;2;2;s3,i_swc,
#base#,S0,#ic_scope#,
>
<lim_var_de59b9f7;2;s10,s6,
_c_dlydis;dly1;2;2;s7,s10,
#Freq#,1,S0,
_c_lim;lim1;2;2;s9,s8,
H,L,1,S0,
dt*#PLL_lim_up#
;
-dt*#PLL_lim_low#
_c_sum;sum1;3;3;s8,s6,s7,
0,1,S0,
+1 -1
_c_sum;sum2;3;3;s10,s9,s7,
#Freq#,1,S0,
+1 +1
>
<limit_d8fe1ae4;4;s208,s197,s206,s207,
_c_fu;Fm13;3;3;s204,s197,s206,
0,S0,
[MIN]
_c_fu;Fm14;3;3;s207,s208,s204,
0,S0,
[MAX]
>
<limit_d8fe4ea2;4;s208,s197,s206,s207,
_c_fu;Fm13;3;3;s204,s197,s206,
0,S0,
[MIN]
_c_fu;Fm14;3;3;s207,s208,s204,
0,S0,
[MAX]
>
<limit_d8fe5d6a;4;s208,s197,s206,s207,
_c_fu;Fm13;3;3;s204,s197,s206,
0,S0,
[MIN]
_c_fu;Fm14;3;3;s207,s208,s204,
0,S0,
[MAX]
>
<limit_d8fe1784;4;s208,s197,s206,s207,
_c_fu;Fm13;3;3;s204,s197,s206,
0,S0,
[MIN]
_c_fu;Fm14;3;3;s207,s208,s204,
0,S0,
[MAX]
>
<limit_e27cb83d;4;s208,s197,s206,s207,
_c_fu;Fm13;3;3;s204,s197,s206,
0,S0,
[MIN]
_c_fu;Fm14;3;3;s207,s208,s204,
0,S0,
[MAX]
>
<mPQ__3_2f14de06;10;s29a,s29b,s29c,s2a,s2b,s2c,s27P,s27Q,s54Pini,s54Qini,
_SwMeter;swa;2;2;s29a,s2a,
>i,
_SwMeter;swb;2;2;s29b,s2b,
>i,
_SwMeter;swc;2;2;s29c,s2c,
>i,
_c_dly;dly1;2;2;s11,s3,
1,0,#period#,
_c_dly;dly1;2;2;s12,s10,
1,0,#period#,
_c_dly;dly2;2;2;s19,s18,
1,0,#period#,
_c_dly;dly2;2;2;s16,s15,
1,0,#period#,
_c_dly;dly3;2;2;s37,s35,
1,0,#period#,
_c_dly;dly3;2;2;s25,s24,
1,0,#period#,
_c_dly;dlya;2;2;s14,s48,
1,0,#quarter_period#,S0,
_c_dly;dlyb;2;2;s47,s49,
1,0,#quarter_period#,S0,
_c_dly;dlyc;2;2;s40,s50,
1,0,#quarter_period#,S0,
_c_fu;Fm1;3;3;s31,s48,i_swa,
0,
[PROD]
_c_fu;Fm1;3;3;s7,s14,i_swa,
0,
[PROD]
_c_fu;Fm2;3;3;s8,s47,i_swb,
0,
[PROD]
_c_fu;Fm2;3;3;s30,s49,i_swb,
0,
[PROD]
_c_fu;Fm3;3;3;s6,s40,i_swc,
0,
[PROD]
_c_fu;Fm3;3;3;s32,s50,i_swc,
0,
[PROD]
_c_i;Int1;2;2;s3,s31,
0,
_c_i;Int1;2;2;s10,s7,
0,
_c_i;Int2;2;2;s15,s8,
0,
_c_i;Int2;2;2;s18,s30,
0,
_c_i;Int3;2;2;s35,s6,
0,
_c_i;Int3;2;2;s24,s32,
0,
_c_loss;Div1;2;2;s36,s9,
#period#,
_c_loss;Div1;2;2;s44,s13,
#period#,
_c_loss;Div2;2;2;s34,s23,
#period#,
_c_loss;Div2;2;2;s22,s20,
#period#,
_c_loss;Div3;2;2;s42,s39,
#period#,
_c_loss;Div3;2;2;s28,s26,
#period#,
_c_prbv;p3;2;2;s48,s29a,
0,
_c_prbv;p4;2;2;s49,s29b,
0,
_c_prbv;p5;2;2;s50,s29c,
0,
_c_sel;P;4;4;s27P,s43,s54Pini,s4,
#Pic#,S0,#Pscope#,
_c_sel;Q;4;4;s27Q,s46,s54Qini,s51,
#Qic#,S0,#Qscope#,
_c_sum;sum1;3;3;s9,s3,s11,
0,1,
+1 -1
_c_sum;sum1;3;3;s13,s10,s12,
0,1,
+1 -1
_c_sum;sum2;3;3;s20,s18,s19,
0,1,
+1 -1
_c_sum;sum2;3;3;s23,s15,s16,
0,1,
+1 -1
_c_sum;sum3;3;3;s39,s35,s37,
0,1,
+1 -1
_c_sum;sum3;3;3;s26,s24,s25,
0,1,
+1 -1
_c_sum;sum4;4;4;s51,s34,s42,s44,
0,1,
+1 +1 +1
_c_sum;sum4;4;4;s4,s22,s28,s36,
0,1,
+1 +1 +1
_x_PFpart;FPperiod;1;1;s43,
0,
1+ (t >= #period#)
_x_QFpart;FQperiod;1;1;s46,
0,S0,
1+ (t >= 1.25* #period#)
>
<period_integral_3bdd52a;2;out,in,
_c_dly;dly2;2;2;old_integral,new_integral,
1,0,#period#,
_c_i;Int1;2;2;new_integral,in,
0,
_c_sum;sum2;3;3;out,new_integral,old_integral,
0,1,
+1 -1
>
<polar_to_xy_f8c49f51;4;x,y,mag,rad,
_c_fu;Fm1;3;3;x,mag,rad,
0,
u[1] * COS( u[2] )
_c_fu;Fm2;3;3;y,mag,rad,
0,
u[1] * SIN( u[2] )
>
<refProcessing_dfeb5f52;14;s15controlMode,s15QorVac,s15Pref,s15Qref,s15Vac_ref,s15f_ref,s15Vdc_ref,
s10Pref,s10Qref,s10Vac_ref,s10Vdc_ref,s10f_ref,s10controlMode,s10QorVac,
_c_fu;Fm1;2;2;s10f_ref,s15f_ref,
0,S0,
#Freq#*(#Choice_regulator#>0)+u[1]
_c_fu;Fm2;2;2;s10QorVac,s15QorVac,
0,S0,
#Choice_QVac_regulator#+u[1]
_c_fu;Fm3;2;2;s10controlMode,s15controlMode,
0,S0,
#Choice_regulator#+u[1]
_c_fu;Fm4;2;2;s10Vdc_ref,s5,
0,S0,
#Vdc_ref#+u[1]
_c_fu;Fm5;2;2;s10Vac_ref,s20,
0,S0,
#Vac_ref#+u[1]
_c_fu;Fm6;2;2;s10Qref,s17,
0,S0,
#Qref#+u[1]
_c_fu;Fm7;2;2;s10Pref,s16,
0,S0,
#Pref#+u[1]
_c_loss;to_pu1;2;2;s5,s15Vdc_ref,
#Vdc_V#,S0,
_c_loss;to_pu7;2;2;s20,s15Vac_ref,
#Vac_primary_V#,S0,
_c_loss;to_pu8;2;2;s17,s15Qref,
#S_VA#,S0,
_c_loss;to_pu9;2;2;s16,s15Pref,
#S_VA#,S0,
>
<selector_de94c1ce;7;s23,s22,s27,s28,s21,s26,s24,
_c_sel;Sel3;7;7;s23,s24,s22,s22,s22,s21,s22,
1,S0,
_c_sel;Sel4;7;7;s28,s24,s27,s27,s27,s26,s27,
1,S0,
>
<t2_a35baada;5;s28,s20,s15,s18,s21,
_c_fu;Fm1;4;4;s21,s28,s15,s20,
0,S0,
(u[1]-u[3])/SQRT(3)
_c_fu;Fm2;4;4;s18,s28,s15,s20,
0,S0,
-1/3*u[1] + 2/3*u[2] - 1/3*u[3]
>
<t3_a45ffd6b;6;s17,s19,s18,s12,s76,s16,
_c_fu;Fm2;4;4;s76,s17,s18,s19,
0,S0,
2/3*u[1] - 1/3*u[2] - 1/3*u[3]
_c_fu;Fm3;4;4;s12,s17,s18,s19,
0,S0,
1/SQRT(3)*(u[2] - u[3])
_c_fu;Fm4;4;4;s16,s17,s18,s19,
0,S0,
1/3*(u[1] + u[2] + u[3])
>
<xfmr_YDp30_unit_ed26f7eb;4;i,j,k,m,
_RLC;RL1;2;2;i,s36,
#R1#,#L1#,0,0,0,
#W1_scope#,
_RLC;RL2;2;2;s31,k,
#R2#,#L2#,0,0,0,
#W2_scope#,
_Tr0;Tygyg;4;4;s36,j,s31,m,
#Ratio#,,,
_x_Lnonl;Lmag;2;2;s36,j,
1,#Phi0#,1e-08,
#Lmag_scope#,
#ILnonl# #PhiLnonl#
_x_Rmag;Rmag;2;2;s36,j,
#Rm#,,,,,
>
<xy_to_polar_f5231a56;4;x,y,mag,rad,
_c_fu;Fm1;3;3;mag,xc,yc,
0,
[NORM]
_c_fu;Fm2;3;3;rad,xc,yc,
0,
u[2] ATAN2 u[1]
_c_fu;Fm4;2;2;xc,x,
0,
CLEAN_ZERO( u[1] )
_c_fu;Fm5;2;2;yc,y,
0,
CLEAN_ZERO( u[1] )
>
<xy_to_polar_fe7005c4;4;x,y,mag,rad,
_c_fu;Fm1;3;3;mag,xc,yc,
0,
[NORM]
_c_fu;Fm2;3;3;rad,xc,yc,
0,
u[2] ATAN2 u[1]
_c_fu;Fm4;2;2;xc,x,
0,
CLEAN_ZERO( u[1] )
_c_fu;Fm5;2;2;yc,y,
0,
CLEAN_ZERO( u[1] )
>
<AC_meter1_b4016292;12;s3a,s3b,s3c,s21a,s21b,s21c,s29va,s29vb,s29vc,s15ia,s15ib,s15ic,
@Cjump_ba13a882;connector1;2;i_swb,s15ib,
@Cjump_ba13a882;connector2;2;i_swa,s15ia,
@Cjump_ba13a882;connector3;2;i_swc,s15ic,
_Sw0;swa;2;2;s3a,s21a,
-1,1E15,0,0,0,,1,.1,.001,5,>i,
_Sw0;swb;2;2;s3b,s21b,
-1,1E15,0,0,0,,1,.1,.001,5,>i,
_Sw0;swc;2;2;s3c,s21c,
-1,1E15,0,0,0,,1,.1,.001,5,>i,
_c_prbv;P4;2;2;s29va,s21a,
0,S0,
_c_prbv;P5;2;2;s29vb,s21b,
0,S0,
_c_prbv;P6;2;2;s29vc,s21c,
0,S0,
>
<AVG_FRQ_INV_9e2e4e89;3;In,s6,s11,
@Delais_variable_b60c2f36;Variable_delay;3;s3,s1,s33,
_c_dlydis;dly2;2;2;s10,In,
0,1,S0,
_c_fu;Fm7;4;4;s26,s3,s1,s6,
0,S0,
(u[2]-u[1]) * u[3]
_c_fu;Fm8;2;2;N,s17,
0,S0,
1/u[1]/dt
_c_fu;Fm9;2;2;F,N,
0,S0,
TRUNC(u[1]) + 1
_c_fu;Fm10;2;2;s33,F,
0,S0,
dt * u[1]
_c_fu;Fm11;5;5;s28,N,F,In,s10,
0,S0,
(u[1]-u[2])/u[1] * (u[3] + ((u[3]-u[4]) * (u[1]-u[2])) / 2)
_c_fu;Fm12;4;4;s11,s15,s2,In,
0,S0,
(u[2] == 1) * u[1]
+
(u[2] == 0) * u[3]
_c_gstep;sg2;1;1;s2,
1,100,0,#Period#,0,S0,
_c_i;Int1;2;2;s1,In,
0,S0,
_c_lim;lim2;2;2;s17,s6,
1e6,1e-6,1,S0,
_c_sum;sum2;3;3;s15,s26,s28,
0,1,S0,
+1 +1
>
<AVM_inverter_a34c9bcd;9;s11,s8,BUS3a,BUS3b,BUS3c,Varef,Vbref,Vcref,s35,
@DC_side_a1f74f4f;DCside1;7;Ia,Ib,Ic,s274,Vbref,Varef,Vcref,
@SMV_97b36dfb;Vmeas1;3;s34,s11,Vc_tot,
@Vac_ae114dfb;AC_side_phA;3;s6,Vc_tot,Varef,
@Vac_ae114dfb;AC_side_phB;3;s3,Vc_tot,Vbref,
@Vac_ae114dfb;AC_side_phC;3;s4,Vc_tot,Vcref,
@ip__3_aecc3541;Iac;9;BUS3a,BUS3b,BUS3c,BUS2a,BUS2b,BUS2c,Ia,Ib,Ic,
base=1;
ia_scope='';
ib_scope='';
ic_scope='';
_D0;D1;2;2;s11,s34,
0.7,0,0,
_RLC;C1;2;2;s37,s11,
0,0,#AVM_Ceq_C#,0,#Vdc_V#,
_RLC;Larm_equi;2;2;s5,BUS2c,
0,#AVM_Leq_AC_H#,0,0,0,
_RLC;Larm_equi1;2;2;s1,BUS2b,
0,#AVM_Leq_AC_H#,0,0,0,
_RLC;Larm_equi2;2;2;s17,BUS2a,
0,#AVM_Leq_AC_H#,0,0,0,
_RLC;Req_DC;2;2;s34,s8,
#AVM_Req_Ohm#,0,0,0,0,
_cI;cI1;3;3;s34,s11,s274,
0,1e15,
_cSw;cSW1;3;3;s34,s37,s33,
1,,1e15,1,1e-03,1e09,
_cV;cV1;3;3;s5,,s4,
0,1e15,
_cV;cV2;3;3;s1,,s3,
0,1e15,
_cV;cV3;3;3;s17,,s6,
0,1e15,
_c_fu;Fm1;2;2;s33,s35,
0,S0,
[NOT]
>
<Current_limit_cb340cd3;4;Iq_ref_in,Id_ref_in,Id_ref_out,Iq_ref_out,
@limit_d8fe4ea2;Limiter1;4;s9,s5,Iq_ref_in,Iq_ref_out,
@limit_d8fe4ea2;Limiter2;4;s18,s4,Id_ref_in,Id_ref_out,
_c_cst;C2;1;1;s2,
#I_lim#,S0,
_c_cst;C14;1;1;s82,
#I_lim#,S0,
_c_fu;Fm3;3;3;s10,s2,Id_ref_out,
0,S0,
SQRT(u[1]*u[1]-u[2]*u[2])
_c_fu;Fm5;2;2;s4,s56,
0,S0,
(#P_priority#==1)*#Id_lim# +
 (#P_priority#==0)*u[1]
_c_fu;Fm6;2;2;s5,s10,
0,S0,
(#P_priority#==0)*#Iq_lim# + 
(#P_priority#==1)*u[1]
_c_fu;Fm7;3;3;s56,s82,Iq_ref_out,
0,S0,
SQRT(u[1]*u[1]-u[2]*u[2])
_c_gain;Gain3;2;2;s9,s5,
-1,S0,
_c_gain;Gain5;2;2;s18,s4,
-1,S0,
>
<Current_reference_calculation_bec54670;5;s67,s62,s66,s50,s1,
@limit_d8fe1784;DEV8;4;s7,s62,s62,s3,
_c_cst;C3;1;1;s7,
0.01,S0,
_c_fu;Fm1;3;3;s66,s67,s3,
0,S0,
u[1]/u[2]
_c_fu;Fm2;3;3;s50,s3,s1,
0,S0,
u[2]/u[1]
>
<DC_Voltage_Controller_97641e46;3;s38,s20,Vdc_ref,
@Derive_b2d937ec;DEV3;2;s42,s84,
Td_d=0.002;
tau_d=0.001;
_c_fu;Fm3;3;3;s38,s39,s84,
0,S0,
[SUM]
_c_fu;Fm7;2;2;s39,s42,
0,S0,
u[1]/#droopCtrl_Kp#
_c_sum;sum1;3;3;s42,Vdc_ref,s20,
0,1,S0,
+1 -1
>
<PI_REG_a7aa2024;6;s6,s9,s32,s14,s45,s44,
@limit_d8fe5d6a;DEV1;4;s44,s45,s54,s14,
_c_dlydis;dly2;2;2;s50,s51,
0,1,S0,
_c_fu;Fm1;3;3;s3,s6,s9,
0,S0,
[PROD]
_c_fu;Fm3;3;3;s35,s34,s32,
0,S0,
[PROD]
_c_ilim;Int2;4;4;s34,s29,s7,s8,
0,1e50,-1e50,S0,
_c_sum;sum1;3;3;s54,s3,s35,
0,1,S0,
+1 +1
_c_sum;sum4;3;3;s29,s9,s50,
0,1,S0,
+1 +1
_c_sum;sum5;3;3;s51,s14,s54,
0,1,S0,
+1 -1
>
<PI_REG_a7ae33cf;6;s3,s6,s32,s11,s12,s15,
@limit_d8fe1ae4;saturation;4;s15,s12,s1,s11,
_c_dlydis;dly2;2;2;s50,s51,
0,1,S0,
_c_fu;Fm1;3;3;s17,s3,s6,
0,S0,
[PROD]
_c_fu;Fm3;3;3;s35,s34,s32,
0,S0,
[PROD]
_c_ilim;Int2;4;4;s34,s29,s7,s8,
0,1e50,-1e50,S0,
_c_sum;sum2;3;3;s1,s35,s17,
0,1,S0,
+1 +1
_c_sum;sum4;3;3;s29,s6,s50,
0,1,S0,
+1 +1
_c_sum;sum5;3;3;s51,s11,s1,
0,1,S0,
+1 -1
>
<PI_REG_a33e9f45;8;s3,s6,s32,s11,s12,s15,s2,s5,
@limit_e27cb83d;saturation;4;s15,s12,s1,s11,
_c_dlydis;dly2;2;2;s50,s51,
0,1,S0,
_c_fu;Fm1;3;3;s17,s3,s6,
0,S0,
[PROD]
_c_fu;Fm3;3;3;s9,s13,s32,
0,S0,
[PROD]
_c_ilim;Int2;4;4;s8,s9,s2,s5,
0,1e50,-1e50,S0,
_c_sum;sum2;3;3;s1,s8,s17,
0,1,S0,
+1 +1
_c_sum;sum4;3;3;s13,s6,s50,
0,1,S0,
+1 +1
_c_sum;sum5;3;3;s51,s11,s1,
0,1,S0,
+1 -1
>
<PI_controller_fixed_ec8f33a2;3;out_ini,u,out,
@PI_ini_e9892eed;PI_ini;3;out_ini,u,iudt_ini,
_c_i;iudt;2;2;iudt,u,
H,S0,
iudt_ini
_c_sum;out;3;3;out,iudt,u,
0,1,S0,
#PLL_ki# #PLL_kp# 
>
<PQ_calculations_d3c82771;7;s13,s17,I_alpha_Y,I_beta_Y,V_alpha_Y,V_beta_Y,s7,
@LP_filter_2nd_odrer_adb07a20;LP_filter_2nd1;2;s13,s3,
wT_2=0.0000012923620362543085;
wT_eps=0.0016077077074234038;
@LP_filter_2nd_odrer_adb07a20;LP_filter_2nd2;2;s17,s6,
wT_2=0.0000012923620362543085;
wT_eps=0.0016077077074234038;
@LP_filter_2nd_odrer_adb07a20;LP_filter_2nd3;2;s7,s8,
wT_2=0.0000012923620362543085;
wT_eps=0.0016077077074234038;
_c_fu;Fm1;3;3;s8,V_alpha_Y,V_beta_Y,
0,S0,
SQRT(u[1]*u[1]+u[2]*u[2])
_c_fu;Fm2;5;5;s3,V_alpha_Y,I_alpha_Y,V_beta_Y,I_beta_Y,
0,S0,
u[1]*u[2]+u[3]*u[4]
_c_fu;Fm3;5;5;s6,V_alpha_Y,I_alpha_Y,V_beta_Y,I_beta_Y,
0,S0,
-u[1]*u[4]+u[3]*u[2]
>
<ParkClark_inv_c0d90a42;7;s29,s24,s25,s32,s33,s34,s35,
@Clark_inv_c2f82dc9;Clark_inv1;6;s29,s24,s25,s37,s36,s38,
@Park_inv_cda700ad;Parc_inv3;7;s32,s33,s34,s35,s36,s37,s38,
>
<YgD_m30_3b9e5b1d;6;Ya,Yb,Yc,DELTAa,DELTAb,DELTAc,
@xfmr_YDp30_unit_ed26f7eb;xfmr_A;4;Ya,,DELTAa,DELTAb,
Phi0=Phiss01
@xfmr_YDp30_unit_ed26f7eb;xfmr_B;4;Yb,,DELTAb,DELTAc,
Phi0=Phiss02
@xfmr_YDp30_unit_ed26f7eb;xfmr_C;4;Yc,,DELTAc,DELTAa,
Phi0=Phiss03
>
<d_q_transformation_dde89b17;20;s19va,s19vb,s19vc,s16ia,s16ib,s16ic,s21va,s21vb,s21vc,s25ia,s25ib,
s25ic,s22,s57,s39,s40,s42,s43,s55,s56,
@t2_a35baada;Clark_Y1;5;s16ia,s16ic,s16ib,s55,s56,
@t2_a35baada;Clark_Y2;5;s19va,s19vc,s19vb,s57,s22,
@t3_a45ffd6b;Clark_D1;6;s21va,s21vc,s21vb,s39,s40,s41,
@t3_a45ffd6b;Clark_D2;6;s25ia,s25ic,s25ib,s42,s43,s44,
>
<dq_transfomrations_e8b572d1;9;Vd,Vq,theta,I_beta_D,I_alpha_D,Iq,Id,V_alpha_Y,V_beta_Y,
@ABC_DQ0_c4caaa96;Park_I;7;I_alpha_D,I_beta_D,Id,Iq,s15,0,theta,
@ABC_DQ0_c4caaa96;Park_V;7;V_alpha_Y,V_beta_Y,Vd,Vq,s8,0,theta,
>
<period_average_3774e30;2;average,in,
@period_integral_3bdd52a;DEV2;2;integral,in,
_c_loss;Div1;2;2;average,integral,
#period#,
>
<xy_to_polar_3ph_27e9706;12;a_x,a_y,b_x,b_y,c_x,c_y,a_mag,a_rad,b_mag,b_rad,c_mag,c_rad,
@xy_to_polar_fe7005c4;DEV1;4;a_x,a_y,a_mag,a_rad,
@xy_to_polar_fe7005c4;DEV2;4;b_x,b_y,b_mag,b_rad,
@xy_to_polar_fe7005c4;DEV3;4;c_x,c_y,c_mag,c_rad,
>
<InnerControl_bba2db71;9;Vabc_refVa_ref,Vabc_refVb_ref,Vabc_refVc_ref,m,s2,s3,theta,s45,s72,
@polar_to_xy_f8c49f51;ph_4;4;s15,s60,m,s6,
@xy_to_polar_f5231a56;ph_3;4;s2,s3,s64,s6,
@ParkClark_inv_c0d90a42;ParkClark_inv;7;Vabc_refVa_ref,Vabc_refVb_ref,Vabc_refVc_ref,theta,s5,s60,
s15,
_c_cst;C2;1;1;s5,
0,S0,
_c_fu;Fm2;3;3;s70,s64,s45,
0,S0,
[DIV]
_c_lim;lim2;2;2;m,s69,
1.5,0,1,S0,
_c_sel;Sel1;7;7;s69,s72,s70,s70,s64,s70,s70,
1,S0,
>
<InnerControl_be83f348;8;s13,s16,s17,s19,s22,s21,s2,s3,
@LPfilter_2nOrder_b0042544;LPfilter_1st5;2;s5,s17,
wT=0.014468631190172306;
@LPfilter_2nOrder_b0042544;LPfilter_1st6;2;s14,s16,
wT=0.014468631190172306;
@PI_REG_a7ae33cf;PI_control1;6;s25,s23,s52,s6,s12,s33,
@PI_REG_a7ae33cf;PI_control2;6;s36,s20,s37,s7,s11,s84,
_c_cst;C1;1;1;s37,
#Ictrl_Ki#,S0,
_c_cst;C2;1;1;s11,
0.6,S0,
_c_cst;C3;1;1;s52,
#Ictrl_Ki#,S0,
_c_cst;C4;1;1;s25,
#Ictrl_Kp#,S0,
_c_cst;C5;1;1;s36,
#Ictrl_Kp#,S0,
_c_cst;C7;1;1;s12,
0.6,S0,
_c_cst;Xarm_equivalent1;1;1;s4,
#Lac_equi_pu#,S0,
_c_fu;Fm1;3;3;s156,s19,s4,
0,S0,
[PROD]
_c_fu;Fm2;3;3;s158,s4,s21,
0,S0,
[PROD]
_c_gain;Gain1;2;2;s84,s11,
-1,S0,
_c_gain;Gain2;2;2;s33,s12,
-1,S0,
_c_scope;id;1;1;s19,
,
_c_scope;id_ref;1;1;s13,
,
_c_scope;iq;1;1;s21,
,
_c_scope;iq_ref;1;1;s22,
,
_c_sum;sum1;3;3;s23,s13,s19,
0,1,S0,
+1 -1
_c_sum;sum2;4;4;s2,s6,s158,s5,
0,1,S0,
-1 +1 +1
_c_sum;sum3;3;3;s20,s22,s21,
0,1,S0,
+1 -1
_c_sum;sum4;4;4;s3,s7,s14,s156,
0,1,S0,
-1 +1 -1
>
<PLL_9ddb8001;4;s8,wt,s15,s36,
@ABC_DQ0_b7d00b1b;Park1;7;s8,s15,s3,s7,s12,s26,wt,
@LP_filter_2nd_odrer_dc2ce5e1;LP_filter_2nd1;2;s9,s5,
wT_2=0.000028144773233982722;
wT_eps=0.007502635967975885;
@lim_var_de59b9f7;Limiter_Variation;2;s5,s25,
@AVG_FRQ_INV_9e2e4e89;Avg_Mean_Freq;3;s7,s36,s14,
@PI_controller_fixed_ec8f33a2;PI_Ctrl;3;s18,s14,s13,
_c_dlydis;dly2;2;2;s36,s9,
#Freq#,1,S0,
_c_fu;Fm3;1;1;s18,
0,S0,
2*pi*#Freq#
_c_fu;Fm4;2;2;wt,s4,
0,S0,
(u[1]) MODULO (2*pi)
_c_fu;Fm5;2;2;s25,w,
0,S0,
u[1] / (2*pi)
_c_i;Int1;2;2;s4,w,
0,S0,
_c_lim;lim3;2;2;w,s13,
H,L,1,S0,
1.25*2*pi*#Freq#
;
0.75*2*pi*#Freq#
>
<PQcontrol_b7bfc968;13;s16,s3,s66,s117,Vdc,Vac_grid,s2,s8,s20,s73,controlMode,s90,Vdc_ref,
@DC_Droop_Voltage_96768198;deadband_control2;5;s369,Vdc,s279,s280,s58,
@LP_filter_2nd_odrer_adb07a20;LP_filter_2nd2;2;s89,Vac_grid,
wT_2=0.00009894646840072048;
wT_eps=0.014067442439954783;
@LPfilter_2nOrder_c60d6d67;HPfilter_1st1;2;s19,s1,
wT=0.019894367886486918;
init_value=0;
@Current_limit_cb340cd3;Idq_ref_limiter2;4;s6,s60,s16,s3,
@Current_reference_calculation_bec54670;Power_to_Current;5;s371,s89,s141,s4,s102,
@DC_Voltage_Controller_97641e46;Droop_control1;3;s11,Vdc,Vdc_ref,
droopCtrl_Kp=droopCtrl_Kp;
@PI_REG_a7aa2024;PI_control;6;0,s187,s15,s180,s77,s23,
@PI_REG_a7aa2024;PI_control1;6;0,s21,s25,s7,s24,s26,
@PI_REG_a7aa2024;PI_control2;6;s265,s91,s267,s12,s232,s227,
@PI_REG_a7aa2024;PI_control3;6;0,s50,s44,s29,s96,s48,
_c_cst;C2;1;1;s24,
0.5,S0,
_c_cst;C3;1;1;s25,
#VacCtrl_Ki#,S0,
_c_cst;C6;1;1;s265,
#VdcCtrl_Kp#,S0,
_c_cst;C14;1;1;s267,
#VdcCtrl_Ki#,S0,
_c_cst;C28;1;1;s96,
0.5,S0,
_c_cst;C29;1;1;s44,
#Qctrl_Ki#,S0,
_c_cst;C40;1;1;s15,
#Pctrl_Ki#,S0,
_c_cst;C41;1;1;s77,
1.2,S0,
_c_cst;C48;1;1;s232,
1.2,S0,
_c_cst;C50;1;1;s280,
0.95,S0,
_c_cst;C51;1;1;s279,
1.05,S0,
_c_cst;C52;1;1;s58,
#Pctrl_Vdc_Kp#,S0,
_c_gain;Gain1;2;2;s26,s24,
-1,S0,
_c_gain;Gain2;2;2;s102,s29,
-1,S0,
_c_gain;Gain3;2;2;s1,s2,
0.2,S0,
_c_gain;Gain9;2;2;s48,s96,
-1,S0,
_c_gain;Gain14;2;2;s23,s77,
-1,S0,
_c_gain;Gain15;2;2;s227,s232,
-1,S0,
_c_scope;P;1;1;s117,
,
_c_scope;Pref;1;1;s10,
,
_c_scope;Q;1;1;s66,
,
_c_scope;Qref;1;1;s20,
,
_c_scope;Vac_ref;1;1;s73,
,
_c_scope;Vdc;1;1;Vdc,
,
_c_scope;Vdc_ref;1;1;s37,
,
_c_sel;Sel1;7;7;s13,controlMode,0,0,s11,0,0,
1,S0,
_c_sel;Sel2;4;4;s6,s90,s4,s18,
1,S0,
_c_sel;Sel6;7;7;s14,controlMode,s369,0,0,0,0,
1,S0,
_c_sel;Sel7;7;7;s60,controlMode,s141,s12,s141,0,0,
1,S0,
_c_sel;Sel12;7;7;s37,controlMode,0,Vdc_ref,0,0,0,
1,S0,
_c_sum;sum1;3;3;s187,s10,s117,
0,1,S0,
+1 -1
_c_sum;sum2;3;3;s21,s73,Vac_grid,
0,1,S0,
+1 -1
_c_sum;sum3;3;3;s18,s7,s19,
0,1,S0,
+1 -1
_c_sum;sum4;3;3;s371,s180,s14,
0,1,S0,
+1 +1
_c_sum;sum5;3;3;s50,s20,s66,
0,1,S0,
+1 -1
_c_sum;sum6;3;3;s10,s8,s13,
0,1,S0,
+1 +1
_c_sum;sum7;3;3;s91,s37,Vdc,
0,1,S0,
+1 -1
>
<period_harmonic_xy_4133d4d;3;in,x,y,
@period_average_3774e30;DEV1;2;a,in_cos,
@period_average_3774e30;DEV2;2;b,in_sin,
_c_fu;Fm1;2;2;in_cos,in,
0,
2 * u[1] * COS( #k# * 2 * pi / #period# * t )
_c_fu;Fm3;2;2;in_sin,in,
0,
2 * u[1] * SIN( #k# * 2 * pi / #period# * t )
_c_fu;Fm6;2;2;x,a,
0,
u[1] * ( 1 - (#k# == 0) * 0.5 )
_c_gain;Mu1;2;2;y,b,
-1,
>
<power_angle_ca11aa9;7;s64,s10,s8,s2,s7,s18,s20,
@LPfilter_2nOrder_c60d6d67;HPfilter_1st2;2;s19,s66,
wT=0.019894367886486918;
init_value=0;
@PI_REG_a33e9f45;PI_control1;8;s14,s29,s6,s13,s3,s9,s50,0,
_c_cst;C2;1;1;s6,
#VFctrl_Ki#,S0,
_c_cst;LimitUp;1;1;s3,
1.5,S0,
_c_cst;Vq_ref;1;1;s2,
0,S0,
_c_cst;limitDown;1;1;s9,
-0.3,S0,
_c_fu;Fm2;1;1;s50,
0,S0,
(t<0.05)
_c_gain;Gain2;2;2;s66,s8,
0.3,S0,
_c_gain;n;2;2;s15,s12,
#droop_n#,S0,
_c_scope;V_grid;1;1;s64,
,
_c_scope;Vref;1;1;s1,
,
_c_sum;sum1;3;3;s11,s13,s1,
0,1,S0,
+1 +1
_c_sum;sum2;3;3;s10,s11,s19,
0,1,S0,
+1 +1
_c_sum;sum3;3;3;s29,s1,s64,
0,1,S0,
+1 -1
_c_sum;sum4;3;3;s1,s7,s15,
0,1,S0,
+1 -1
_c_sum;sum5;3;3;s12,s18,s20,
0,1,S0,
+1 -1
>
<3ph_to_seq_xy_a5a5fefd;9;a,b,c,zero_x,zero_y,pos_x,pos_y,neg_x,neg_y,
@xy_to_polar_fe7005c4;DEV5;4;b_x,b_y,b_mag,b_rad,
@xy_to_polar_fe7005c4;DEV6;4;c_x,c_y,c_mag,c_rad,
@period_harmonic_xy_4133d4d;DEV1;3;a,a_x,a_y,
k=1;
@period_harmonic_xy_4133d4d;DEV2;3;b,b_x,b_y,
k=1;
@period_harmonic_xy_4133d4d;DEV3;3;c,c_x,c_y,
k=1;
_c_fu;Fm1;3;3;b1_x,b_mag,b_rad,
0,
u[1] * COS( u[2] + 2.094395102 )
_c_fu;Fm2;3;3;b1_y,b_mag,b_rad,
0,
u[1] * SIN( u[2] + 2.094395102 )
_c_fu;Fm3;3;3;b2_x,b_mag,b_rad,
0,
u[1] * COS( u[2] - 2.094395102 )
_c_fu;Fm4;3;3;b2_y,b_mag,b_rad,
0,
u[1] * SIN( u[2] - 2.094395102 )
_c_fu;Fm5;3;3;c1_y,c_mag,c_rad,
0,
u[1] * SIN( u[2] + 2.094395102 )
_c_fu;Fm6;3;3;c2_x,c_mag,c_rad,
0,
u[1] * COS( u[2] - 2.094395102 )
_c_fu;Fm7;3;3;c2_y,c_mag,c_rad,
0,
u[1] * SIN( u[2] - 2.094395102 )
_c_fu;Fm8;3;3;c1_x,c_mag,c_rad,
0,
u[1] * COS( u[2] + 2.094395102 )
_c_fu;Fm9;4;4;pos_x,a_x,b1_x,c2_x,
0,
[SUM] / 3
_c_fu;Fm10;4;4;neg_x,a_x,b2_x,c1_x,
0,
[SUM] / 3
_c_fu;Fm11;4;4;zero_y,a_y,b_y,c_y,
0,
[SUM] / 3
_c_fu;Fm12;4;4;pos_y,a_y,b1_y,c2_y,
0,
[SUM] / 3
_c_fu;Fm13;4;4;neg_y,a_y,b2_y,c1_y,
0,
[SUM] / 3
_c_fu;Fm14;4;4;zero_x,a_x,b_x,c_x,
0,
[SUM] / 3
>
<Synchronisation_f2082ef7;6;s15,s16,s14,s17,s5,s6,
@Oscillator_fef34d3b;Oscillator2;4;s11,s4,s5,s6,
@PLL_9ddb8001;PLL1;4;s15,s20,s16,s25,
_c_scope;Freq_Hz;1;1;s25,
,
_c_sel;Sel2;7;7;s14,s17,s20,s20,s20,s11,s20,
1,S0,
>
<3ph_to_seq_polar_a5a555d7;9;a,b,c,zero_mag,zero_rad,pos_mag,pos_rad,neg_mag,neg_rad,
@xy_to_polar_3ph_27e9706;DEV3;12;zero_x,zero_y,pos_x,pos_y,neg_x,neg_y,zero_mag,zero_rad,pos_mag,
pos_rad,neg_mag,neg_rad,
@3ph_to_seq_xy_a5a5fefd;DEV1;9;a,b,c,zero_x,zero_y,pos_x,pos_y,neg_x,neg_y,
>
<VSC_Control_e1ddcef0;27;s470va,s470vb,s470vc,s472ia,s472ib,s472ic,s466va,s466vb,s466vc,s468ia,
s468ib,s468ic,Vdc_meas,s86,s111,P,Q,s5controlMode,s5QorVac,s5Pref,s5Qref,s5Vac_ref,s5f_ref,
s5Vdc_ref,s59Va_ref,s59Vb_ref,s59Vc_ref,
@Cjump_8c2b0376;unnamed;2;s5Pref,Pref,
@Cjump_8c2b0376;unnamed;2;s5Vac_ref,Vac_ref,
@Cjump_8c2b0376;unnamed;2;s5controlMode,controlMode,
@Cjump_8c2b0376;unnamed;2;s5Qref,Qref,
@LP_filter_2nd_odrer_c64125af;LP_filter_2nd2;2;s86,Vdc_meas,
wT_2=0.000001274095664734392;
wT_eps=0.001596305525101252;
init_value=1;
@selector_de94c1ce;selector;7;s61,s60,s62,s63,s68,s20,controlMode,
@PQ_calculations_d3c82771;signal_calculations;7;P,Q,s73,s72,s83,s167,s101,
@d_q_transformation_dde89b17;Clarke_transfo;20;s466va,s466vb,s466vc,s468ia,s468ib,s468ic,s470va,
s470vb,s470vc,s472ia,s472ib,s472ic,s83,s167,s18,s17,s162,s163,s72,s73,
@dq_transfomrations_e8b572d1;dq_transfo;9;s1,s92,s111,s162,s163,s121,s120,s83,s167,
@InnerControl_bba2db71;Linearization_dq2abc;9;s59Va_ref,s59Vb_ref,s59Vc_ref,s16,s61,s63,s111,s86,
controlMode,
@InnerControl_be83f348;Inner_Control2;8;s112,s92,s1,s120,s113,s121,s60,s62,
@PQcontrol_b7bfc968;Outer_Control;13;s112,s113,Q,P,s86,s101,s121,s5Pref,s5Qref,s5Vac_ref,
s5controlMode,s5QorVac,s5Vdc_ref,
@power_angle_ca11aa9;VF_control1;7;s101,s68,s120,s20,Vac_ref,Qref,Q,
@Synchronisation_f2082ef7;Synchronization1;6;s83,s167,s111,controlMode,Pref,P,
>
<UpperCtrl_and_Protection_dc8aabe7;32;s437va,s437vb,s437vc,s149ia,s149ib,s149ic,s147va,s147vb,
s147vc,s435ia,s435ib,s435ic,s165Va_ref,s165Vb_ref,s165Vc_ref,s135,s167,s169,activate_AC_BRK,
activate_ConvBRK,s42,s173,block_MMC,s171,s197,s6controlMode,s6QorVac,s6Pref,s6Qref,s6Vac_ref,
s6f_ref,s6Vdc_ref,
@Convert_to_pu_eb71bfc1;convert_pu1;28;s147va,s147vb,s147vc,s434va,s434vb,s434vc,s435ia,s435ib,
s435ic,s436ia,s436ib,s436ic,s437va,s437vb,s437vc,s438va,s438vb,s438vc,s149ia,s149ib,s149ic,s440ia,
s440ib,s440ic,s135,s213,s197,s198,
@Convert_to_pu_eb74323d;LP_filter1;28;s434va,s434vb,s434vc,s4va,s4vb,s4vc,s436ia,s436ib,s436ic,s3ia,
s3ib,s3ic,s438va,s438vb,s438vc,s470va,s470vb,s470vc,s440ia,s440ib,s440ic,s153ia,s153ib,s153ic,s213,
s134,s198,s199,
wT_2=6.332573977646112e-9;
wT_eps=0.00011253953951963827;
@Protect_StartUp_cb9ecf8d;Protect_StartUp;8;activate_ConvBRK,s199,activate_AC_BRK,block_MMC,s42,
s4va,s4vb,s4vc,
@VSC_Control_e1ddcef0;UpperCtrl1;27;s470va,s470vb,s470vc,s153ia,s153ib,s153ic,s4va,s4vb,s4vc,s3ia,
s3ib,s3ic,s134,s173,s171,s167,s169,s6controlMode,s6QorVac,s6Pref,s6Qref,s6Vac_ref,s6f_ref,s6Vdc_ref,
s165Va_ref,s165Vb_ref,s165Vc_ref,
>
<circuit_V_seq_89dd3646;9;s1a,s1b,s1c,zero_mag,zero_rad,pos_mag,pos_rad,neg_mag,meg_rad,
@Vprobe3_118c9ca5;p1;6;va,vb,vc,s1a,s1b,s1c,
@3ph_to_seq_polar_a5a555d7;DEV1;9;va,vb,vc,zero_mag,zero_rad,pos_mag,pos_rad,neg_mag,meg_rad,
>
<AVM inverter_20554abd;5;s13a,s13b,s13c,s104,s151,
@Filters_b7d9430f;filter1;3;AC_Convertera,AC_Converterb,AC_Converterc,
@Main_Sw_d37eb50a;AC_BRK3;7;s32a,s32b,s32c,s106a,s106b,s106c,activate_AC_BRK,
@Main_Sw_d37fc89b;AC_convertor_BRK2;7;s28a,s28b,s28c,AC_Convertera,AC_Converterb,AC_Converterc,
activate_ConvBRK,
@SMV_bfbafbc8;DEV2;3;s123,s151,Vdc_V,
@i_probe_b08db5cf;Idc3;3;s123,s104,Idc_A,
scope='';
base=1;
@initialization_ddd00238;LF_init1;6;s13a,s13b,s13c,s32a,s32b,s32c,
@refProcessing_dfeb5f52;ref;14;s4controlMode,s4QorVac,s4Pref,s4Qref,s4Vac_ref,s4f_ref,s4Vdc_ref,
s1Pref,s1Qref,s1Vac_ref,s1Vdc_ref,s1f_ref,s1controlMode,s1QorVac,
@AC_meter1_b4016292;Primary2;12;s106a,s106b,s106c,s102a,s102b,s102c,Vac_primary_Vva,Vac_primary_Vvb,
Vac_primary_Vvc,Iac_primary_Aia,Iac_primary_Aib,Iac_primary_Aic,
@AC_meter1_b4016292;Secondary3;12;s22a,s22b,s22c,s28a,s28b,s28c,Vac_secondary_Vva,Vac_secondary_Vvb,
Vac_secondary_Vvc,Iac_secondary_Aia,Iac_secondary_Aib,Iac_secondary_Aic,
@AVM_inverter_a34c9bcd;inverter;9;s151,s123,AC_Convertera,AC_Converterb,AC_Converterc,
Vabc_refVa_ref,Vabc_refVb_ref,Vabc_refVc_ref,block_converter,
@YgD_m30_3b9e5b1d;step_up_Xmr;6;s102a,s102b,s102c,s22a,s22b,s22c,
R1=0.4897028571428572;
L1=0.10196970805500058;
Rm=0;
PhiLnonl=[0];
ILnonl=[0];
Lnonl='Exclude';
Rmag='Exclude';
R2=0.00030857142857142845;
L2=0.00006425312416824231;
Phiss01=0;
Phiss02=0;
Phiss03=0;
Ratio=0.07530655685082074;
Lmag_scope='';
W1_scope  ='';
W2_scope  ='';
@UpperCtrl_and_Protection_dc8aabe7;UpperCtrl_Protec1;32;Vac_secondary_Vva,Vac_secondary_Vvb,
Vac_secondary_Vvc,Iac_secondary_Aia,Iac_secondary_Aib,Iac_secondary_Aic,Vac_primary_Vva,
Vac_primary_Vvb,Vac_primary_Vvc,Iac_primary_Aia,Iac_primary_Aib,Iac_primary_Aic,Vabc_refVa_ref,
Vabc_refVb_ref,Vabc_refVc_ref,Vdc_V,P,Q,activate_AC_BRK,activate_ConvBRK,StarPointReactor_BRK,s117,
block_converter,s119,Idc_A,s1controlMode,s1QorVac,s1Pref,s1Qref,s1Vac_ref,s1f_ref,s1Vdc_ref,
_RLC;R1a;2;2;AC_Convertera,,
10M,0,0,0,0,,60,,0,0,
_RLC;R1b;2;2;AC_Converterb,,
10M,0,0,0,0,,60,,0,0,
_RLC;R1c;2;2;AC_Converterc,,
10M,0,0,0,0,,60,,0,0,
_RLC;R2a;2;2;s28a,AC_Convertera,
1000,0,0,0,0,
_RLC;R2b;2;2;s28b,AC_Converterb,
1000,0,0,0,0,
_RLC;R2c;2;2;s28c,AC_Converterc,
1000,0,0,0,0,
>
!
!
@Vprobe3_330f7b90;p1;6;s12,s23,s18,s20a,s20b,s20c,
base=1;
va_scope='?s';
vb_scope='?s';
vc_scope='?s';
@mPQ__3_2f14de06;PQ_DG;10;s20a,s20b,s20c,s8a,s8b,s8c,s3P,s3Q,s1Pini,s1Qini,
period=0.016666666666666666;
quarter_period=0.004166666666666667;
Pscope='?s';
Pic=2;
PFpart='Exclude';
Qscope='?s';
Qic=2;
QFpart='Exclude';
@circuit_V_seq_89dd3646;pseq1;9;s20a,s20b,s20c,s4,s6,s11,s13,s14,s15,
period=0.016666666666666666;
@AVM inverter_20554abd;VSC_1;5;s20a,s20b,s20c,s5,s10,
 activate_Protection =0;
 Choice_regulator =1;
 S_VA =2500000;
 AVM_Ceq_C =0.05;
 AVM_Leq_AC_H =0.000001909859317102744;
 AVM_Leq_DC_H =0.0000025464790894703255;
 AVM_Req_Ohm =0.0006666666666666666;
 Choice_QVac_regulator =1;
 CloseTime_AC_BRK =0;
 CloseTime_converter_BRK =0;
 Csm_C =0.008333333333333333;
 DeblockTime_SMs =0;
 ExcludeLtransfoMag ='Exclude';
 ExcludeRtransfoMag ='Exclude';
 Freq =60;
 I_lim =1.1;
 Iac_primary_A =147.9160472695156;
 Iac_secondary_A =3402.0690871988586;
 Ictrl_Ki =346.67713828024034;
 Ictrl_Kp =1.1324786517154514;
 Id_lim =1.1;
 Idc_A =1250;
 Idc_limit =6;
 Iq_lim =0.6;
 init_Protection =0.3;
 droopCtrl_Kp =0.1;
 Lac_equi_pu =0.7115573225153072;
 Larm_H =0.000003819718634205488;
 LF_Q_VAR =0;
 LF_P1_W =2500000;
 LF_V =11267.65281680262;
 Ltransfo_sec_H =0.00006425312416824231;
 Ltransfo_prim_H =0.10196970805500058;
 Mag_Currrent_A =[5.1031 25.5155 63.7888 127.5776 255.1552 5103.1036];
 Mag_Flux_Wb =[1440.5061 1548.5441 1656.5820 1728.6073 1771.8225 2477.6705];
 Nsm =1;
 P_priority =0;
 Pctrl_Ki =30;
 Pctrl_Kp =0;
 Pctrl_Vdc_Kp =10;
 period =0.016666666666666666;
 Period =0.016666666666666666;
 PLL_lim_low =12;
 PLL_lim_up =12;
 PLL_max_delay =0.0223;
 PLL_ki =1600;
 PLL_kp =80;
 Pref =-1;
 Pref_FallingSlewRate =60;
 Pref_RisingSlewRate =5;
 Qctrl_Ki =30;
 Qctrl_Kp =0;
 Qref =0;
 Qref_FallingSlewRate =60;
 Qref_RisingSlewRate =5;
 Ron_IGBT_Ohm =0.001;
 Rtransfo_sec_Ohm =0.00030857142857142845;
 RtransfoMag_Ohm =13948020000;
 Rtransfo_prim_Ohm =0.4897028571428572;
 Start_up =0;
 StarPointReactor_BRK =0;
 t_init =0.1;
 t_init_close1 =-1;
 t_init_close2 =1e-15;
 Transfo_ratio =13.279056191361393;
 TstrP =0;
 V_Csm_init =2000;
 V_ref =0.1;
 Vac_primary_V =11267.65281680262;
 Vac_ref =1;
 Vac_secondary_V =489.89794855663564;
 VacCtrl_Ki =39.99999999999999;
 VacCtrl_Kp =0;
 VdcCtrl_Ki =293.8775510204082;
 VdcCtrl_Kp =9.6;
 Vdc_ref =4.2;
 Vdc_ref_FallingSlewRate =60;
 Vdc_ref_RisingSlewRate =5;
 Vdc_V =2000;
 VFctrl_Ki =39.99999999999999;
 VFctrl_Kp =0;
 Vsm_V =2000;
 X_PCC_pu =0.75;
 X_PCC1_pu =0.75;
 Rfilter1_Ohm =1e15;
 Lfilter1_H =1e5;
 Cfilter1_F =1e-9;
 droop_m =0;
 droop_n =0;
 Xarm_pu =0.01
_RLC;C1;2;2;s10,,
0,0,1nF,0,0,,60,,0,0,
_RLC;C2a;2;2;s17a,,
0,0,62.86uF,0,0,,60,,0,0,
_RLC;C2b;2;2;s17b,,
0,0,62.86uF,0,0,,60,,0,0,
_RLC;C2c;2;2;s17c,,
0,0,62.86uF,0,0,,60,,0,0,
_RLC;L1a;2;2;s17a,,
0,130mH,0,0,0,,60,,0,0,
_RLC;L1b;2;2;s17b,,
0,130mH,0,0,0,,60,,0,0,
_RLC;L1c;2;2;s17c,,
0,130mH,0,0,0,,60,,0,0,
_RLC;R1a;2;2;s17a,,
76,0,0,0,0,,60,,0,0,
_RLC;R1b;2;2;s17b,,
76,0,0,0,0,,60,,0,0,
_RLC;R1c;2;2;s17c,,
76,0,0,0,0,,60,,0,0,
_Slack;LF1a;3;1;s2a,
60,13.8kVRMSLL,0,1,,1Ohm,,,
_Slack;LF1b;3;1;s2b,
_Slack;LF1c;3;1;s2c,
1	0	0
0	1	0
0	0	1
10	0	0
0	10	0
0	0	10
_Sw0;SW1a;2;2;s8a,s17a,
-1,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW1b;2;2;s8b,s17b,
-1,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW1c;2;2;s8c,s17c,
-1,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW2a;2;2;s17a,s2a,
-1,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW2b;2;2;s17b,s2b,
-1,1E15,0,0,0,,1,.1,.001,5,
_Sw0;SW2c;2;2;s17c,s2c,
-1,1E15,0,0,0,,1,.1,.001,5,
_VMn;V_DGa;1;1;s20a,
?v,
_VMn;V_DGb;1;1;s20b,
?v,
_VMn;V_DGc;1;1;s20c,
?v,
_Vp;DC1;2;2;s5,s10,
2kV,-1,1E15,
_Vsine_z;VwZ1a;6;2;s9a,s2a,
13.8kVRMSLL,60,0,-1,1E15,Slack:LF1,1,,1Ohm,,0,
_Vsine_z;VwZ1b;6;2;s9b,s2b,
13.8kVRMSLL,60,-120,-1,1E15,0,
_Vsine_z;VwZ1c;6;2;s9c,s2c,
13.8kVRMSLL,60,120,-1,1E15,0,
1 0 0
0 1 0
0 0 1
10 0 0
0 10 0
0 0 10
_c_freq;m1;4;4;s7,s23,s19,s22,
0,45,75,S0,
_c_scope;V1;1;1;s11,
?s,
_c_scope;freq;1;1;s7,
?s,
